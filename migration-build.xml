<?xml version="1.0" encoding="UTF-8"?>

<project name="c5migration" basedir=".">

    <target name="create-migrations" description="Create empty database">
        <java classname="play.modules.c5migration.MigrationMain" failonerror="yes">
            <classpath refid="play.classpath"/>
            <arg line="create ${basedir}/conf/application.conf"/>
        </java>
    </target>

    <target name="drop-migrations" description="Drop database (use with caution!)">
        <java classname="play.modules.c5migration.MigrationMain" failonerror="yes">
            <classpath refid="play.classpath"/>
            <arg line="drop ${basedir}/conf/application.conf"/>
        </java>
    </target>

    <target name="run-migrations" description="Apply all pending migrations">
        <java classname="play.modules.c5migration.MigrationMain" failonerror="yes">
            <classpath refid="play.classpath"/>
            <arg line="migrate ${basedir}/conf/application.conf"/>
        </java>
    </target>

    <target name="reset-migrations" description="Drop the existing database, create a new one, and apply all pending migrations (use with caution!)">
        <java classname="play.modules.c5migration.MigrationMain" failonerror="yes">
            <classpath refid="play.classpath"/>
            <arg line="reset ${basedir}/conf/application.conf"/>
        </java>
    </target>

    <target name="new-migration" description="Create a new, empty migration script">
        <input message="Short description (optional)" addproperty="migration.description" defaultvalue=""/>
        <java classname="play.modules.c5migration.MigrationMain" failonerror="yes">
            <classpath refid="play.classpath"/>
            <sysproperty key="description" value="${migration.description}"/>
            <arg line="new ${basedir}/conf/application.conf"/>
        </java>
    </target>

    <target name="check-migrations" description="Check for pending migrations, fail the build if the db is not up to date">
        <java classname="play.modules.c5migration.MigrationMain" failonerror="yes">
            <classpath refid="play.classpath"/>
            <arg line="check ${basedir}/conf/application.conf"/>
        </java>
    </target>

</project>